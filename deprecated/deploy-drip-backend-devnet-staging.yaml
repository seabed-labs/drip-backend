name: Deploy Drip Backend Devnet Staging

on:
  push:
    branches:
      - "main"

permissions: write-all

jobs:
  deploy:
    name: deploy
    uses: dcaf-labs/drip-backend/.github/workflows/deploy-drip-backend.yaml@main
    with:
      DRIP_PROGRAM_ID: "F1NyoZsUhJzcpGyoEqpDNbUMKVvCnSXcCki1nN3ycAeo"
      ENV: "STAGING"
      NETWORK: "DEVNET"
      port: "8080"
      PSQL_USER: "postgres"
      PSQL_PORT: "5432"
      PSQL_DBNAME: "drip-devnet-staging"
      PSQL_HOST: "database-1.cluster-czi7cvr73oui.us-east-1.rds.amazonaws.com"
      REGISTRY: "434618599721.dkr.ecr.us-east-1.amazonaws.com/drip-backend-devnet-staging"
      IMAGE_TAG: "latest"
    secrets:
      DISCORD_ACCESS_TOKEN: "${{ secrets.DEVNET_STAGING_DISCORD_ACCESS_TOKEN }}"
      DISCORD_WEBHOOK_ID: "${{ secrets.DEVNET_STAGING_DISCORD_WEBHOOK_ID }}"
      DRIP_BACKEND_WALLET: "${{ secrets.DEVNET_STAGING_DRIP_BACKEND_WALLET }}"
      PSQL_PASS: "${{ secrets.DEVNET_STAGING_PSQL_PASS }}"
      GOOGLE_CLIENT_ID: "${{ secrets.GOOGLE_CLIENT_ID }}"
      AWS_ACCESS_KEY_ID: "${{ secrets.AWS_ACCESS_KEY_ID }}"
      AWS_SECRET_ACCESS_KEY: "${{ secrets.AWS_SECRET_ACCESS_KEY }}"